# Nagent
网络穿透代理，名称来源于Nat与Agent的组合。类似frp项目，可以穿透局域网为互联网提供服务。  
前提是你要有一台流量服务器并且有一个公网IP。如果没有，也可以找服务商。  
暂不能向frp那样为HTTP服务，但可以实现简单的分发————你只需要在两台内网HTTP服务器上运行Nagent客户端即可。  
  
## 名词解释
客户端：运行在内网的Nagent客户端。  
服务端：运行在公网服务器上的Nagent服务端。  
用户：互联网上的实际用户。  
  
## 过程
服务器监听在5670端口（默认）。  
客户端配置好自己的服务端口，也可以指定内网其他计算机。假设本机80端口。  
客户端登录到服务器，通知服务器我需要监听的外网端口，比如90。  
一切正常的话（防火墙没问题，端口没被占用等），服务器上90端口的连接即会被导向到内网的80端口服务上。  
  
## 原理
客户端与服务器保持着一定数量的连接，每个连接都需要登录成功。  
用户连接公网服务器的端口后会从客户端的列表中弹出一个用于数据转发。  
当客户端第一次收到数据时，建立与本地服务的连接，并发送/转发数据。  

## 部署
需要NodeJS 
  
## 运行为服务端
windows/linux:  
node nagent.js -s  
linux:  
./nagent.js -s  
  
## 运行为客户端
windows/linux:  
node nagent.js -p 90 -P 80  
linux:  
./nagent.js -p 90 -P 80  
  
## 配置
保存下面内容到nagent.js所在的目录，文件名为nagent.config，方括号内替换为你的参数。  
local_port=\[你的本地服务端口\]  
server_port=5670// 服务端端口号  
server_host='\[服务端的主机地址，IP或域名均可\]'  
remote_port=\[你需要服务端为你开放的公网端口\]  
keep_conn_count=10// 同时保持的最大连接数量  
  
